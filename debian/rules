#!/usr/bin/make -f
#export DH_VERBOSE = 1

export DEB_CPPFLAGS_APPEND=-DOPENTHREAD_BUILD_DATETIME=\"$(SOURCE_DATE_EPOCH)\"

%:
	dh $@

override_dh_auto_configure:
	dh_auto_configure -- -GNinja \
                -DOPENTHREAD_BUILD_DATETIME=\"$(SOURCE_DATE_EPOCH)\" \
                -DCMAKE_INSTALL_PREFIX=/usr \
                -DCMAKE_EXPORT_COMPILE_COMMANDS=ON \
                -DOTBR_DBUS=1 \
                -DOTBR_MDNS=avahi \
                -DOTBR_REST=1 \
                -DOTBR_WEB=1 \
                -DOTBR_DNSSD_DISCOVERY_PROXY=ON \
                -DOTBR_SRP_ADVERTISING_PROXY=ON \
                -DOTBR_BACKBONE_ROUTER=ON \
                -DOTBR_BORDER_ROUTING=ON \
                -DOTBR_DUA_ROUTING=ON \
		-DOT_POSIX_CONFIG_RCP_BUS=SPI \
                -DOT_THREAD_VERSION=1.3 \
                -DOT_FTD=1 \
                -DOT_MTD=1 \
                -DOT_RCP=ON \
                -DOT_COMPILE_WARNING_AS_ERROR=ON \
                \
                -DOT_COAP_BLOCK=ON \
                -DOT_COAP_OBSERVE=ON \
                -DOT_CHANNEL_MANAGER=ON \
                -DOT_CHANNEL_MONITOR=ON \
                -DOT_CHILD_SUPERVISION=ON \
                -DOT_DATASET_UPDATER=ON \
                -DOT_DHCP6_CLIENT=ON \
                -DOT_DHCP6_SERVER=ON \
                -DOT_DIAGNOSTIC=ON \
                -DOT_DNS_CLIENT=ON \
                -DOT_IP6_FRAGM=ON \
                -DOT_JAM_DETECTION=ON \
                -DOT_LOG_OUTPUT=PLATFORM_DEFINED \
                -DOT_MTD_NETDIAG=ON \
                -DOT_NEIGHBOR_DISCOVERY_AGENT=ON \
                -DOT_PING_SENDER=ON \
                -DOT_POSIX_MAX_POWER_TABLE=ON \
                -DOT_SNTP_CLIENT=ON \
                -DOT_SRP_CLIENT=ON \
                -DOT_RCP_RESTORATION_MAX_COUNT=2 \
                -DOT_REFERENCE_DEVICE=ON \
                -DOT_COVERAGE=OFF \
                -B . -S

override_dh_fixperms:
	dh_fixperms
	cp -rfp script debian/ot-br-posix/usr/share/ot-br-posix/
	rm -rf debian/ot-br-posix/usr/lib



override_dh_auto_test:


